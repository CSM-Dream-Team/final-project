% vim: spell spelllang=en_us
\documentclass[conference,12pt]{IEEEtran}
\usepackage[T1]{fontenc}
\usepackage[utf8]{inputenc}
\usepackage[english]{babel}
\usepackage{csquotes}
\usepackage{biblatex}
\usepackage{amsmath}
\usepackage{minted}
\usepackage[inline]{enumitem}
\usepackage{amsthm}
\usepackage{mdframed}

\MakeOuterQuote{"}

\addbibresource{references.bib}

\setminted{autogobble,python3,mathescape,fontsize=\footnotesize}
\newcommand\tab[1][.5in]{\hspace*{#1}}
\newcommand\name{VRsh}
\newtheorem{definition}{Definition}

\title{Final Project Report}
\author{%
    \IEEEauthorblockN{%
        Jonathan Sumner Evans\IEEEauthorrefmark{1},
        Robinson Merillat\IEEEauthorrefmark{2}, and
        Sam Sartor\IEEEauthorrefmark{3}
    }
    \IEEEauthorblockA{%
        Department of Computer Science,
        Colorado School of Mines\\
        Golden, Colorado\\
        Email:
            \IEEEauthorrefmark{1}jonathanevans@mines.edu,
            \IEEEauthorrefmark{2}rdmerillat@mines.edu,
            \IEEEauthorrefmark{3}ssartor@mines.edu
    }
}

\begin{document}

\maketitle

\begin{abstract}
    Virtual Reality (VR) Technology has been developing rapidly over the past
    decade. Current solutions such as Unity attempt to use old programming
    languages and paradigms to implement VR environments and thus limit
    developers' abilities to create new and unique environments. With every
    cutting edge technology, new paradigms and design patterns must be invented.
    In this paper, we discuss a deferred immediate mode (DIM) application
    architecture suitable for implementing large virtual reality applications.
    We present a library which utilizes this architecture and a few case studies
    of this library in use.
\end{abstract}

\section{Introduction}
The Virtual Reality (VR) market is growing rapidly. The International Data
Corporation (IDC) projects that revenues for the combined Augmented Reality (AR)
and Virtual Reality markets will grow from \$5.2 billion in 2016 to more than
\$162 billion in 2020~\cite{IDC:2016:VR-industry}. This flourishing new industry
has created an exciting new field of Software Engineering with great potential
for revolutionary new design paradigms and program architectures.

Most current frameworks and libraries attempt to apply old design paradigms and
program architectures that are well-suited for 2D user interfaces and rendering
3D environments to a flat screen to virtual reality. Although these endeavors
have been successful, they do not fully explore potential new design paradigms
and program architectures.

Our goal is to find a system that provides a modern, fast, and practical
approach to virtual reality development. Specifically, we require that this
system meets the following criteria.

\subsection{Performant}
% TODO: add citations about frame rate's affects on health in here
Virtual Reality requires a very high frame rate. A virtual reality program must
be capable of generating 90 frames per second (fps); thus the effective required
frame rate is 180fps.  Achieving this frame rate is resource intensive and
requires highly efficient and optimized code. Additionally, multithreading is
imperative so that long-running processes can occur without blocking the user
interface. This is unlike a traditional desktop user interface where blocking
the UI process for a second does not have a major affect on the usability of the
program. These factors require a VR framework that is highly performant and
multi-threadable.

\subsection{Natural User Interface}
A \textit{natural user interface} is an interface that can be used without the
need for a controller~\cite{Wimmers:2015:VR:Natural-UI}. Although current VR
systems utilize hand-held controllers, they emulate this goal much better than
desktop, mobile, and web applications. For our discussion of these natural user
interfaces, we define the following terms.

\begin{definition}
    A {\normalfont\text{planar UI}} is a user interface where components are
    organized along a 2D surface.
\end{definition}

\begin{definition}
    A {\normalfont\text{spacial UI}} is a user interface where components are
    organized within a 3D space.
\end{definition}

% TODO: better word than uniform?
\begin{definition}
    A {\normalfont\text{uniform UI}} element is a user interface element where
    the functionality of the element depends on at most 2 dimensions.
\end{definition}

\begin{definition}
    A {\normalfont\text{volumetric UI}} element is a user interface element
    where the functionality of the element depends on 3 dimensions.
\end{definition}

All of these user interfaces and user interface elements can be natural user
interfaces. For example, a physical-word planar UI would be a painter's palate.
Spacial UI is found in <TODO>.  Uniform UIs are found in the physical world in
the form of levers and sliders. An example of volumetric UI in the physical
world is <TODO>.

Because Virtual Reality environments are inherently 3D, they make spacial UI and
volumetric UI elements convenient and practical for the first time. Thus, the
ability to create spacial UI and volumetric UI elements rather than merely to
planar UI and uniform UI is a high priority.

\subsection{Programmable}
% TODO: better intro sentence? (I've been putting the "we need X" towards the
% end of the section the paragraph)
% TODO: this seems to intersect a lot with the next two sections.
We need a framework that prioritizes application development over game
development---a software development kit first and foremost. Features such as
character rigging, pathfinding, and high-fidelity materials are not necessary
for non-entertainment software. For example, existing frameworks for classical
application development (e.g.\ HTML and GTK) do not include any of these
features. The easy programmatic definition and use of user interface components
must take priority.

\subsection{Flexible}
% TODO: can do anything, infinite possible applications -> need to be expandable
As evidenced by the massive breadth of desktop, mobile, and web applications,
the number of software applications is nearly infinite. The virtual reality
field is no different, and VR application architectures must be scalable,
adaptable, and <TODO> in order to enable this diversity. In other words, an
architecture must not be opinionated about which types of application should be
created with it. % TODO: something about why WE need this

\subsection{Modular}
% TODO: don't want pathfinding, etc if we don't need it
A direct result of flexibility is modularity---a flexible architecture cannot be
a monolith. Many current VR architectures have features such as pathfinding and
character rigging baked in which must be included even if they are not used. We
want an architecture which has a minimal feature set baked in while still
allowing extensibility via addition of self-containing modules.

\begin{center}***\end{center}

Given these criteria, we evaluate current program architectures including entity
component systems, React-like architectures, and event tree architectures in
Section~\ref{sec:evolution}. We also describe how these architectures influenced
our deferred immediate mode architecture which we formally present in
Section~\ref{sec:dim}. In Section~\ref{sec:flight} we describe Flight---an
implementation of a VR UI library using the referred immediate mode
architecture. Then we present three case studies of Flight and the deferred
immediate mode architecture in use in real applications in
Section~\ref{sec:case-studies} and conclude in Section~\ref{sec:conclusion}.

\section{Evolution of Deferred Immediate Mode}\label{sec:evolution}
% TODO: Give brief overview of our "adventures in VR library design"

\subsection{Entity Component System}
% TODO:

\subsection{React-Like Architecture}
% TODO:
% TODO: mention A-Frame

\subsection{Event Tree}

\section{Deferred Immediate Mode}\label{sec:dim}
% TODO: describe general ideals of our architecture (programming language and
% implementation agnostic)
% TODO: mention how our deferred immediate mode program architecture builds on
% and combines concepts from many previous architectures

\subsection{Deferred}
% TODO: describe why this is cool

\subsection{Immediate Mode}
% TODO: describe why this is cool

\section{Flight}\label{sec:flight}
% TODO: this section should describe the implementation of DIM (or whatever we
% call it)
Flight is our implementation of a VR UI library using the DIM architecture. It
is written in Rust and is designed to be highly modular. It uses Rust
\texttt{FnOnce} closures to implement the deferred aspect of the DIM
architecture and resolves state using a \textit{guru} system.

\subsection{Language}
% TODO: why Rust? Type system.
We chose to implement Flight in Rust for a few reasons.
\begin{enumerate}
    \item \textbf{Performance}: % TODO: ...
    \item \textbf{Type System}: % TODO: ...
    % TODO: more stuff here
\end{enumerate}

\subsection{Dependencies}
The Rust dependency manager, Cargo, allows programmers to easy include
third-party libraries from \url{https://crates.io}. To avoid duplicating work
by other programmers, we utilized a few external libraries for Flight. The main
dependencies are listed below.
\begin{itemize}
    \item \textbf{\texttt{WebVR}}: an OpenVR wrapper built by Mozilla for the
        Servo browser.
    \item \textbf{\texttt{nalgebra}}: library for geometric/volumetric
        operations and queries.
    \item \textbf{\texttt{gfx}}: % TODO:
    % TODO: more dependencies?
\end{itemize}

\subsection{Modular}
% TODO:

\subsection{Deferred}
% TODO: describe how we use FnOnces

\subsection{Immediate Mode}
% TODO: describe how we did this (update function)

\subsection{Gurus} % TODO: maybe lump this in with something else?
% TODO: describe how the gurus help resolve things

% TODO: add subsubsections about the various gurus?

\section{Case Studies}\label{sec:case-studies}
% TODO: Explain that we were creating these applications for a VR independent
% study.

\subsection{Let's Get Physical and Snowflakes --- Physics}
% TODO: Describe how physics, spawning, etc. works in Immediate Mode & Physics
% guru

\subsection{Workbench --- SOMETHING} % TODO
% TODO: Describe how it is used to resolve what is being pointed at.

\subsection{{\name} --- Global User Interface}
% TODO: Describe how we are using it to make the torus thing

\section{Conclusion}\label{sec:conclusion}
% TODO: Conclude (duh)

{\printbibliography}

\end{document}
